PROCEDURE TEMPORARY_WEEK_DISCOUNT(CUSTOMER IN CUSTOMERS.CUSTOMER_ID%TYPE, PERCENT INTEGER)
IS
	BIG_DISCOUNT EXCEPTION;
	LOW_DISCOUNT EXCEPTION;
	WRONG_DISCOUNT EXCEPTION;
	SUM_WEIGHT NUMBER(5,3);
BEGIN
	SELECT SUM_OF_MAX INTO SUM_WEIGHT FROM LOADS, ROUTES 
	WHERE LOADS.LOAD_ID IN (SELECT LOAD_ID FROM LOADS WHERE CUSTOMER_ID = CUSTOMER)
	AND START_TIME >= SYSDATE AND START_TIME <= SYSDATE + 7;
	
	IF PERCENT < 0 OR PERCENT > 100 THEN
		WRONG_DISCOUNT := 1;
		
	ELSIF SUM_WEIGHT < 10 AND PERCENT > 50 THEN
	
		 BIG_DISCOUNT := 1;
		
	ELSIF SUM_WEIGHT > 30 AND PERCENT < 10 THEN
		LOW_DISCOUNT := 1;
          ELSE
             WRONG_DISCOUNT := 0;
             BIG_DISCOUNT := 0 ;

             
                     
	END IF;
	
	UPDATE ROUTES
	SET PRICE = PRICE*((100 - PERCENT)/100)
	WHERE ROUTES.LOAD_ID IN (
		SELECT LOAD_ID FROM LOADS WHERE CUSTOMER_ID = CUSTOMER)
	AND START_TIME >= SYSDATE AND START_TIME <= SYSDATE + 7;
	COMMIT;
	
END TEMPORARY_WEEK_DISCOUNT;
